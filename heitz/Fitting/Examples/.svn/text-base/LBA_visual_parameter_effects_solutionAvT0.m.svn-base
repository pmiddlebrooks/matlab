%85.63	325.74	149.87	141.79	0.57	101.51

figure
srt = 1:1000;
%xsrt = sort(xsrt);

% LBA PDF and CDFs take arguments in this order:
%  t,A,b,v,s

%Use CDFs from QS population data
CDF.slow.correct = [496,0.0866356326703343;523,0.173271265340669;545,0.259906898011003;566,0.346542530681337;588,0.433178163351672;610,0.519813796022006;635,0.606449428692340;665,0.693085061362675;708,0.779720694033009;];
CDF.slow.err = [474,0.0133643673296657;508,0.0267287346593314;532,0.0400931019889971;559,0.0534574693186627;584,0.0668218366483284;610,0.0801862039779941;641,0.0935505713076598;676,0.106914938637325;718,0.120279305966991;];
CDF.med.correct = [217,0.0754581049334377;231,0.150916209866875;243,0.226374314800313;256,0.301832419733751;270,0.377290524667189;285,0.452748629600626;302,0.528206734534064;328,0.603664839467502;364,0.679122944400940;];
CDF.med.err = [227,0.0245418950665623;243,0.0490837901331245;257,0.0736256851996868;271,0.0981675802662490;284,0.122709475332811;298,0.147251370399374;316,0.171793265465936;341,0.196335160532498;373,0.220877055599060;];
CDF.fast.correct = [210,0.0700393820054529;223,0.140078764010906;234,0.210118146016359;244,0.280157528021812;256,0.350196910027264;269,0.420236292032717;283,0.490275674038170;300,0.560315056043623;323,0.630354438049076;];
CDF.fast.err = [219,0.0299606179945471;233,0.0599212359890942;245,0.0898818539836414;257,0.119842471978188;270,0.149803089972736;283,0.179763707967283;297,0.209724325961830;313,0.239684943956377;333,0.269645561950924;];



%starting parameters
start.A = 85.63;
start.b = 0;
start.v = .57;
start.s = .1;
start.T0 = 101.51;

ub.A = 500;
ub.b = 500;
ub.v = .65;
ub.s = 1;
ub.T0 = 800;


for b = start.b:.1:ub.b
    A = start.A;  
    %b = start.b;
    v = start.v;
    s = start.s;
    T0 = start.T0;
    
    
    %srt = SRT + T0;
    
    
    winner = cumsum(linearballisticPDF(srt,A,b,v,s) .* (1-linearballisticCDF(srt,A,b,1-v,s)));
    loser = cumsum(linearballisticPDF(srt,A,b,1-v,s) .* (1-linearballisticCDF(srt,A,b,v,s)));
    
    t = (1:1000) + T0;
    plot(t,winner,'k',t,loser,'r')
    hold on
    plot(CDF.slow.correct(:,1),CDF.slow.correct(:,2),'or',CDF.slow.err(:,1),CDF.slow.err(:,2),'or', ...
        CDF.med.correct(:,1),CDF.med.correct(:,2),'ok',CDF.med.err(:,1),CDF.med.err(:,2),'ok', ...
        CDF.fast.correct(:,1),CDF.fast.correct(:,2),'og',CDF.fast.err(:,1),CDF.fast.err(:,2),'og')
    text(500,.5,['A = ' mat2str(round(A*100)/100)])
    text(500,.45,['b = ' mat2str(round(b*100)/100)])
    text(500,.4,['v = ' mat2str(round(v*100)/100)])
    text(500,.35,['s = ' mat2str(round(s*100)/100)])
    text(500,.3,['T0 = ' mat2str(round(T0*100)/100)])
    xlim([0 1000])
    ylim([0 1])
    pause(.001)
    %pause
    cla
end
