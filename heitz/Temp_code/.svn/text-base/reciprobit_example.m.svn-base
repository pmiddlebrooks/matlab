%plot reciprobit example

%make fake RT distribution
RT = [106,198,210,211,211,214,216,218,218,218,221,221,223,223,224,226,226,227,230,231,233,233,234,234,234,236,237,237,238,238,239,240,241,242,243,243,244,244,244,245,245,246,247,248,248,248,249,249,250,250,252,252,253,253,254,254,255,255,255,256,256,258,258,258,258,259,259,259,259,259,259,260,260,260,260,261,261,261,261,262,262,263,264,264,264,264,265,265,266,266,267,267,267,268,269,270,270,270,270,271,271,272,273,273,274,274,275,275,275,276,276,276,276,276,276,277,277,277,279,282,283,283,284,284,284,286,287,287,287,288,289,290,290,290,290,290,290,291,291,291,292,294,295,295,295,295,295,296,297,297,297,298,298,298,298,300,300,300,301,301,301,303,303,303,305,306,307,307,308,308,309,309,309,311,312,313,313,313,314,314,315,315,315,315,316,317,317,317,318,318,318,318,319,319,320,320,321,321,321,322,322,323,323,323,324,325,325,325,328,328,328,328,330,331,334,334,334,336,336,336,337,337,338,338,338,340,341,341,341,341,341,342,342,342,342,343,344,345,345,346,346,346,347,347,348,349,349,349,351,351,352,353,353,354,354,355,355,357,357,358,358,358,358,360,360,362,363,364,365,365,367,367,368,369,369,370,370,370,370,370,372,374,375,376,377,377,377,378,378,379,382,382,384,385,386,386,387,388,389,389,392,392,392,393,394,394,394,395,395,398,398,399,400,401,403,403,403,404,405,406,406,409,410,410,412,412,412,412,413,413,417,420,422,423,424,424,424,425,428,430,430,433,433,435,435,437,439,439,440,440,442,444,445,445,446,446,446,446,447,448,449,449,450,450,454,455,455,457,457,459,459,461,462,463,464,466,467,467,468,472,474,474,475,477,477,478,478,480,481,481,482,482,484,486,488,490,490,491,492,493,495,495,495,496,497,499,502,504,504,508,510,510,512,512,513,513,513,514,515,515,519,521,524,524,525,525,526,526,526,527,527,528,528,529,529,531,533,534,534,534,535,535,536,539,539,539,541,541,541,541,542,543,544,545,547,548,549,554,554,555,556,558,558,558,559,559,561,564,566,566,567,567,573,574,574,575,575,575,577,577,578,579,579,580,580,581,582,587,587,587,589,590,591,591,591,592,592,594,595,596,596,598,601,602,602,603,604,604,605,607,607,609,610,610,610,611,612,612,612,613,613,613,614,614,614,614,614,614,615,616,616,617,618,618,619,619,620,620,620,622,622,622,623,624,624,624,624,627,627,627,628,628,628,629,630,630,631,631,631,632,632,633,633,633,634,635,638,639,639,639,639,641,643,644,644,646,646,647,647,648,648,650,650,650,650,651,652,652,652,652,652,653,653,655,655,656,657,659,660,661,661,662,662,664,664,667,667,668,668,670,673,674,675,675,676,676,676,677,677,678,680,680,681,683,685,685,687,687,688,688,689,690,690,691,692,692,693,694,695,698,699,699,700,700,701,701,703,704,705,706,707,708,710,712,713,713,713,714,715,718,718,719,719,720,721,721,721,722,722,725,726,726,728,729,730,731,733,734,735,736,736,736,736,737,740,740,740,742,742,745,747,747,749,751,754,761,761,763,766,766,768,770,771,771,772,774,774,776,776,779,779,779,781,781,784,787,789,795,796,797,809,810,811,813,817,819,822,822,826,828,831,833,833,833,837,840,840,842,850,851,855,862,863,871,872,873,888,890,900,912,917,940,944,949,963,976,989,1009,1018,1020,1046,1055,1064,1067,1089,1126,1155,1175,1185,1194,1232,1244,1251,1267,1373,1429,1472,1486,1634,1692,1810,1935,2039,2182];
RT = sort(RT);
RT = RT';



%first, get the cumulative distribution of observed RTs

%this does not need to be sorted to get the cumulative probability, because
%its always just a portion of the RTD so far.  But you have to *PLOT* it by
%the sorted RTs or it won't work. THus, if your distribution was
% [1 2 3 1000 1000 1000], the cumulative p values would be the same as if
% it wasn't sorted, but the plotting wouldn't be right.
p = cumsum(RT./RT)/length(RT);


fig
subplot(3,2,1)
plot(RT,p,'ko')
title('Regular CDF')

%now change RT distribution to reciprocal scale and re-plot
RT_recip = 1./RT;


subplot(3,2,2)
plot(RT_recip,p,'ko')
title('Cum prob as function of 1/RT')

%the 'probit' function is simply the inverse cumulative distribution
%function.  Now we will plot reciprocal of RT on the inverse of the CDF
subplot(3,2,3)
plot(RT_recip,norminv(p),'ko')
title('Inverse CDF as function of 1/RT')


%because it is a reciprocal scale, we'll actually want to reverse the
%x-axis so that right = later
subplot(3,2,4)
plot(-RT_recip,norminv(p), 'ko','MarkerSize',2)
title('Inverse CDF as function of -(1/RT)')


%the time axis is strange, so lets plot it as actual RT

%first set the xlim to range from 150 ms to infinity.
set(gca,'xlim',-1./[150 inf])

%what are the exact RT values you'd like to see on the plot?
xtickvals = [200 300 500 1000 inf]';

%convert the desired x tick values into the reciprocal scale
xtick = sort(-1./xtickvals);

%now set the tick marks to desired locations
set(gca,'xtick',xtick)

%now put the appropriated modified lables
set(gca,'xticklabel',xtickvals)