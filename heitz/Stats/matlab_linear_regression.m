% %how to do linear regression in matlab.
% x = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41];
% y = [8.76775401246844,11.1089616548085,10.5735416475504,9.80973868593456,10.3073281865293,11.9280371607433,13.1063672237473,14.8590805559090,16.6684289110479,17.8450809373290,18.7728505601924,18.8693465724714,19.4119158963400,20.0331067628565,19.3475752847906,18.2419821225830,20.4170082922825,20.1838706809743,21.2160318080749,21.3224801298213,20.4110763066585,19.1770743634720,18.5548149158384,20.8876365096966,22.7506475088555,25.0392002718980,27.4300040390313,29.1380535221577,29.8388424395399,30.8689547162715,30.6491803671096,28.6671414486195,27.5076895271558,27.3514952233720,28.1615499399576,27.8958443061237,28.0258178941773,28.8970713233490,32.0206377907600,33.8143821099527,36.4413026521512];
function [m,b,r] = matlab_linear_regression(x,y)

figure
plot(x,y)

%compute the linear regression of y on x
%[b,bint,r,rint,stats] = regress(y',x')
[p S] = polyfit(x,y,1);

%compute Y predicted

y_pred = polyval(p,x);

hold on
plot(x,y_pred,'r')

m = round(p(1)*1000)/1000;
b = round(p(2)*1000)/1000;
r = round(corr(x',y')*1000)/1000;

text(.25,.8,['Y = ' mat2str(m) 'x + ' mat2str(b)],'units','normalized','fontsize',14)
text(.25,.7,['r = ' mat2str(r)],'units','normalized','fontsize',14)